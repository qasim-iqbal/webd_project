<!doctype html>
<html>
<head>
    <style>
        .bar {
            fill: steelblue;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

     <script src="https://d3js.org/d3.v5.min.js"></script>
    
     <body>

       <div class="container" style="padding-bottom: 7rem;padding-top: 2rem;">

           <h1></h1>
           <div id="d3-container"></div>


        </div>
       <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


      <script>


      const dataSet = async function getData() {
          return await axios.get('/stats/api-data');
      }

      console.log(dataSet)

      
     const articleData = [
        {"Day": "Mon", "Count": 14},
        {"Day": "Tue", "Count": 16},
        {"Day": "Wed", "Count": 20},
        {"Day": "Thu", "Count": 17},
        {"Day": "Fri", "Count": 15},
        {"Day": "Sat", "Count": 8},
        {"Day": "Sun", "Count": 5},



    ];

    const width =800;
    const height =500;
    const margin = 50;
    const chartWidth = width - 2*margin; // 700
    const chartHeight = height -2*margin; // 400

    const colorScale = d3.scaleLinear()
                        .domain([0,30])
                        .range(['white','blue'])

    const xScale = d3.scaleBand() //discrete values
                        .domain(articleData.map( (data) => data.Day))
                        .range([0,chartWidth])
                        .padding(0.5)
    
    const yScale = d3.scaleLinear() //continues
        .domain([0,25])
        .range([chartHeight,0])

    let svg = d3.select('#d3-container')
                .append('svg')
                    .attr('width', width)
                    .attr('height', height);

    svg.append('text')
        .attr('x', width/2)
        .attr('y', height-10 )
        .attr("text-anchor",'middle')
        .text('# articles uploaded by week day')

    let graph = svg.append('g')
                    .attr('transform', `translate(${margin},${margin})`);

    // add x axis
    graph.append('g')
            .attr('transform', `translate(0,${chartHeight})`)
            .call(d3.axisBottom(xScale));
    
    //add y axis
    graph.append('g')
            .call(d3.axisLeft(yScale));

    let rectangles = graph.selectAll('rect')
                        .data(articleData)
                        .enter()
                            .append('rect')
                                .attr('x', (data) => xScale(data.Day))
                                .attr('y', (data) => yScale(data.Count))
                                .attr("width", xScale.bandwidth())
                                .attr("height", (data) => (chartHeight - yScale(data.Count)))
                                .attr('fill',(data) => colorScale(data.Count))

      </script>
      </body>
</html>